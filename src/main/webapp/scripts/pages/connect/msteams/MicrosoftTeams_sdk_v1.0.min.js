var microsoftTeams;!function(t){"use strict";function e(){if(!M){M=!0,w=this._window||window;var t=function(t){return u(t)};w.addEventListener("message",t,!1),C=w.parent!==w.self?w.parent:w.opener;try{k="*";var e=m(C,"initialize",[H]);F[e]=function(t,e){T=t,N=e}}finally{k=null}this._uninitialize=function(){T===D.settings&&W.registerOnSaveHandler(null),T===D.remove&&W.registerOnRemoveHandler(null),M=!1,C=null,k=null,U=[],E=null,S=null,x=[],A=0,F={},T=null,N=null,w.removeEventListener("message",t,!1)}}}function n(t){r();var e=m(C,"getContext");F[e]=t}function i(t){r(),L=t}function o(t){L&&L(t),E&&m(E,"themeChange",[t])}function a(t){r(D.content,D.settings,D.remove);var e=m(C,"navigateCrossDomain",[t]);F[e]=function(t){if(!t)throw new Error("Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.")}}function s(t){r(D.content),m(C,"shareDeepLink",[t.subEntityId,t.subEntityLabel,t.subEntityWebUrl])}function r(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];if(!M)throw new Error("The library has not yet been initialized");if(T&&t&&t.length>0){for(var n=!1,i=0;i<t.length;i++)if(t[i]===T){n=!0;break}if(!n)throw new Error("This call is not allowed in the '"+T+"' context")}}function u(t){if(t&&t.data&&"object"==typeof t.data){var e=t.source||t.originalEvent.source,n=t.origin||t.originalEvent.origin;e===w||n!==w.location.origin&&O.indexOf(n.toLowerCase())===-1||(c(e,n),e===C?f(t):e===E&&l(t))}}function c(t,e){C&&t!==C?E&&t!==E||(E=t,S=e):(C=t,k=e),C&&C.closed&&(C=null,k=null),E&&E.closed&&(E=null,S=null),d(C),d(E)}function f(t){if("id"in t.data){var e=t.data,n=F[e.id];n&&(n.apply(null,e.args),delete F[e.id])}else if("func"in t.data){var e=t.data,i=z[e.func];i&&i.apply(this,e.args)}}function l(t){if("id"in t.data&&"func"in t.data){var e=t.data,n=z[e.func];if(n){var i=n.apply(this,e.args);i&&p(E,e.id,Array.isArray(i)?i:[i])}else{var o=m(C,e.func,e.args);F[o]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];E&&p(E,e.id,t)}}}}function h(t){return t===C?U:t===E?x:[]}function g(t){return t===C?k:t===E?S:null}function d(t){for(var e=g(t),n=h(t);t&&e&&n.length>0;)t.postMessage(n.shift(),e)}function v(t,e){var n=w.setInterval(function(){0===h(t).length&&(clearInterval(n),e())},100)}function m(t,e,n){var i=y(e,n),o=g(t);return t&&o?t.postMessage(i,o):h(t).push(i),i.id}function p(t,e,n){var i=b(e,n),o=g(t);t&&o&&t.postMessage(i,o)}function y(t,e){return{id:A++,func:t,args:e||[]}}function b(t,e){return{id:t,args:e||[]}}var w,C,k,E,S,T,N,L,H="1.0",O=["https://teams.microsoft.com","https://teams.microsoft.us","https://int.teams.microsoft.com","https://devspaces.skype.com","https://ssauth.skype.com","http://dev.local"],z={},D={settings:"settings",content:"content",authentication:"authentication",remove:"remove"},I={desktop:"desktop",web:"web"},M=!1,U=[],x=[],A=0,F={};z.themeChange=o,t.initialize=e,t.getContext=n,t.registerOnThemeChangeHandler=i,t.navigateCrossDomain=a,t.shareDeepLink=s;var W;!function(t){function e(t){r(D.settings,D.remove),m(C,"settings.setValidityState",[t])}function n(t){r(D.settings,D.remove);var e=m(C,"settings.getSettings");F[e]=t}function i(t){r(D.settings),m(C,"settings.setSettings",[t])}function o(t){r(D.settings),c=t}function a(t){r(D.remove),f=t}function s(){var t=new l;c?c(t):t.notifySuccess()}function u(){var t=new h;f?f(t):t.notifySuccess()}var c,f;z["settings.save"]=s,z["settings.remove"]=u,t.setValidityState=e,t.getSettings=n,t.setSettings=i,t.registerOnSaveHandler=o,t.registerOnRemoveHandler=a;var l=function(){function t(){this.notified=!1}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),m(C,"settings.save.success"),this.notified=!0},t.prototype.notifyFailure=function(t){this.ensureNotNotified(),m(C,"settings.save.failure",[t]),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},t}(),h=function(){function t(){this.notified=!1}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),m(C,"settings.remove.success"),this.notified=!0},t.prototype.notifyFailure=function(t){this.ensureNotNotified(),m(C,"settings.remove.failure",[t]),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},t}()}(W=t.settings||(t.settings={}));var R;!function(t){function e(t){if(r(D.content,D.settings,D.remove),N===I.desktop){var e=document.createElement("a");e.href=t.url;var n=m(C,"authentication.authenticate",[e.href,t.width,t.height]);F[n]=function(e,n){e?t.successCallback(n):t.failureCallback(n)}}else a(t)}function n(t){r();var e=m(C,"authentication.getAuthToken",[t.resources]);F[e]=function(e,n){e?t.successCallback(n):t.failureCallback(n)}}function i(t){r();var e=m(C,"authentication.getUser");F[e]=function(e,n){e?t.successCallback(n):t.failureCallback(n)}}function o(){s();try{E&&E.close()}finally{E=null,S=null}}function a(t){g=t,o();var e=g.width||600,n=g.height||400;e=Math.min(e,w.outerWidth-400),n=Math.min(n,w.outerHeight-200);var i=document.createElement("a");i.href=g.url;var a="undefined"!=typeof w.screenLeft?w.screenLeft:w.screenX,s="undefined"!=typeof w.screenTop?w.screenTop:w.screenY;a+=w.outerWidth/2-e/2,s+=w.outerHeight/2-n/2,E=w.open(i.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, top="+s+", left="+a+", width="+e+", height="+n),E?u():h("FailedToOpenWindow")}function s(){d&&(clearInterval(d),d=0),delete z.initialize,delete z.navigateCrossDomain}function u(){s(),d=w.setInterval(function(){if(!E||E.closed)h("CancelledByUser");else{var t=S;try{S="*",m(E,"ping")}finally{S=t}}},100),z.initialize=function(){return[D.authentication,N]},z.navigateCrossDomain=function(t){return!1}}function c(t){r(D.authentication),m(C,"authentication.authenticate.success",[t]),v(C,function(){return w.close()})}function f(t){r(D.authentication),m(C,"authentication.authenticate.failure",[t]),v(C,function(){return w.close()})}function l(t){try{g&&g.successCallback&&g.successCallback(t)}finally{g=null,o()}}function h(t){try{g&&g.failureCallback&&g.failureCallback(t)}finally{g=null,o()}}var g,d;z["authentication.authenticate.success"]=l,z["authentication.authenticate.failure"]=h,t.authenticate=e,t.getAuthToken=n,t.getUser=i,t.notifySuccess=c,t.notifyFailure=f}(R=t.authentication||(t.authentication={}))}(microsoftTeams||(microsoftTeams={}));